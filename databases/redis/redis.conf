# Configuración Redis para Cache y Sesiones

# Configuración de memoria
maxmemory 512mb
maxmemory-policy allkeys-lru

# Persistencia - Configuración balanceada para sesiones
# Guardar si hay al menos 1 cambio en 15 minutos
save 900 1

# Guardar si hay al menos 10 cambios en 5 minutos
save 300 10

# Guardar si hay al menos 10000 cambios en 1 minuto
save 60 10000


# AOF para mayor durabilidad de sesiones
appendonly yes
appendfsync everysec
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# Configuraciones de red
tcp-keepalive 300
timeout 0

# Configuraciones de rendimiento
tcp-backlog 511
databases 16

# Base de datos por defecto para diferentes usos:
# DB 0: Cache general
# DB 1: Sesiones de usuario
# DB 2: Rate limiting
# DB 3: Colas temporales

# Configuraciones de seguridad
protected-mode yes
# requirepass se configura via docker-compose